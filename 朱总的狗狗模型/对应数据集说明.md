# outputs_stage3_long 模型对应的数据集

`outputs_stage3_long` 下的 checkpoint（以及导出的 `model_best.pth`）是用 **ViT_3rd.ipynb** 训练的，对应数据集如下。

---

## 数据集路径

- **文件**：`DogWindows_5sL500_S200__3/windows_all.npz`  
  （相对项目根目录；从 ViT 目录看是 `../DogWindows_5sL500_S200__3/windows_all.npz`）

---

## 数据格式（.npz）

| 键名 | 含义 | 形状/说明 |
|------|------|-----------|
| `X` | 时序特征 | `(N, 500, 16)`，N 为样本数，500 时间步，16 通道 |
| `y_main` | 主类标签（本模型用的） | `(N,)`，字符串或整数，7 类 |
| `y_sub` | 子类标签 | 可选 |
| `dog_id` | 狗 ID | 可选 |
| `start_idx` | 起始索引 | 可选 |
| `cols` | 列名 | 可选 |

---

## 类别（7 类）

- 嗅闻  
- 小跑  
- 抖动  
- 摄入  
- 玩耍  
- 行走  
- 静止  

`num_classes = 7`，标签在代码里会转成连续整数 `0..6`（顺序与 `np.unique(y_main)` 一致）。

---

## 模型输入要求

- **时间长度 T**：500  
- **通道数 C**：16  
- **类别数**：7  

推理时输入张量形状为 `(batch, 500, 16)` 或按你 ViT 里 `ViTTime` 的约定（如 `(batch, 16, 500)`），需与训练时一致。
